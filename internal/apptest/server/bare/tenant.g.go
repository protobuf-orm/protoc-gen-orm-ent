// Code generated by protoc-gen-orm-ent. DO NOT EDIT.
// source: apptest/tenant.proto

package ent

import (
	context "context"
	uuid "github.com/google/uuid"
	apptest "github.com/protobuf-orm/protoc-gen-orm-ent/internal/apptest"
	ent "github.com/protobuf-orm/protoc-gen-orm-ent/internal/apptest/ent"
	codes "google.golang.org/grpc/codes"
	status "google.golang.org/grpc/status"
)

type TenantServiceServer struct {
	Db *ent.Client
	apptest.UnimplementedTenantServiceServer
}

func NewTenantServiceServer(db *ent.Client) TenantServiceServer {
	return TenantServiceServer{Db: db}
}

func (s TenantServiceServer) Add(ctx context.Context, req *apptest.TenantAddRequest) (*apptest.Tenant, error) {
	q := s.Db.Tenant.Create()
	if v, err := uuid.FromBytes(req.GetId()); err != nil {
		return nil, status.Errorf(codes.InvalidArgument, "id: %s", err)
	} else {
		q.SetID(v)
	}
	if req.HasAlias() {
		q.SetAlias(req.GetAlias())
	}
	if req.HasName() {
		q.SetName(req.GetName())
	}
	q.SetLabels(req.GetLabels())
	if req.HasDateCreated() {
		q.SetDateCreated(req.GetDateCreated().AsTime())
	}

	v, err := q.Save(ctx)
	if err != nil {
		return nil, err
	}

	return v.Proto(), nil
}
